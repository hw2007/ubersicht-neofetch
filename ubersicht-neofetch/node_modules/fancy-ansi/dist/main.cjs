"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const m=require("escape-html"),a=require("./colors-b5_C1-gb.cjs");function g({onlyFirst:l=!1}={}){const n=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?(?:\\u0007|\\u001B\\u005C|\\u009C))","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|");return new RegExp(n,l?void 0:"g")}const y=/^(?:\x1b\[([\x3c-\x3f]?)([\d;]*)([\x20-\x2f]?[\x40-\x7e]))|(?:\x1b\[[\x20-\x7e]*([\x00-\x1f:]))/,$=/^\x1b\]8;[\x20-\x3a\x3c-\x7e]*;([\x21-\x7e]{0,512})(?:(?:\x1b\\)|(?:\x07))([\x20-\x7e]+)\x1b\]8;;(?:(?:\x1b\\)|(?:\x07))/,p=/(?:(\x1b\\)|(\x07))|([\x00-\x06]|[\x08-\x1a]|[\x1c-\x1f])/g;class j{constructor(r){this.lastIndex=0,this.input=r}next(){const r=this.input.substring(this.lastIndex),n=r.length;if(n===0)return{value:null,done:!0};const t={kind:0,text:"",url:""},i=r.indexOf("\x1B");if(i===-1)return t.kind=1,t.text=r,this.lastIndex+=n,{value:t,done:!1};if(i>0)return t.kind=1,t.text=r.slice(0,i),this.lastIndex+=i,{value:t,done:!1};if(n<3)return{value:null,done:!0};const s=r.charAt(1);if(s!=="["&&s!=="]"&&s!=="(")return t.kind=2,t.text=r[0],this.lastIndex+=1,{value:t,done:!1};if(s==="["){const o=r.match(y);return o===null?{value:null,done:!0}:o[4]?(t.kind=2,t.text=r[0],this.lastIndex+=1,{value:t,done:!1}):(o[1]!==""||o[3]!=="m"?t.kind=3:t.kind=4,t.text=o[2],this.lastIndex+=o[0].length,{value:t,done:!1})}if(s==="]"){if(n<4)return{value:null,done:!0};if(r.charAt(2)!=="8"||r.charAt(3)!==";")return t.kind=2,t.text=r[0],this.lastIndex+=1,{value:t,done:!1};const o=new RegExp(p);{const h=o.exec(r);if(h===null)return{value:null,done:!0};if(h[3])return t.kind=2,t.text=r[0],this.lastIndex+=1,{value:t,done:!1}}{const h=o.exec(r);if(h===null)return{value:null,done:!0};if(h[3])return t.kind=2,t.text=r[0],this.lastIndex+=1,{value:t,done:!1}}const d=r.match($);return d===null?(t.kind=2,t.text=r[0],this.lastIndex+=1,{value:t,done:!1}):(t.kind=5,t.url=d[1],t.text=d[2],this.lastIndex+=d[0].length,{value:t,done:!1})}return s==="("?(t.kind=3,this.lastIndex+=3,{value:t,done:!1}):{value:null,done:!0}}[Symbol.iterator](){return this}}const f=14,x=new Array(f);x[0]="background-color";x[1]="color";x[2]="font-family";x[3]="font-size";x[4]="font-style";x[5]="font-weight";x[6]="opacity";x[7]="outline";x[8]="text-decoration";x[9]="text-decoration-color";x[10]="text-decoration-line";x[11]="text-decoration-style";x[12]="vertical-align";x[13]="visibility";class u{constructor(){this.attrArray=new Array(f),this._size=0}get(r){return this.attrArray[r]}set(r,n){const t=this.attrArray[r];this.attrArray[r]=n,t===void 0&&n!==void 0&&(this._size+=1)}delete(r){const n=this.attrArray[r];this.attrArray[r]=void 0,n!==void 0&&(this._size-=1)}update(r){for(const n in r)if(r.hasOwnProperty(n)){const t=r[n];this.attrArray[n]=t,t!==void 0&&(this._size+=1)}}clear(){this.attrArray.fill(void 0),this._size=0}get size(){return this._size}toString(){let r="";return this.attrArray.forEach((n,t)=>{n!==void 0&&(r+=`${x[t]}:${n};`)}),r}static delete(...r){return n=>{r.forEach(t=>{n.delete(t)})}}static appendVal(r,n){return t=>{const i=t.get(r),s=i?i.split(" "):[];s.includes(n)||s.push(n),t.set(r,s.join(" "))}}static removeVal(r,n){return t=>{const i=t.get(r);let s=i?i.split(" "):[];s=s.filter(o=>o!==n),s.length?t.set(r,s.join(" ")):t.delete(r)}}}const w=g(),A=g({onlyFirst:!0}),e=new Array(108);e[0]={5:"var(--ansi-bold-font-weight, 600)"};e[1]={5:"var(--ansi-bold-font-weight, 600)"};e[2]={6:"var(--ansi-dim-opacity, 0.7)"};e[3]={4:"italic"};e[4]=u.appendVal(8,"underline");e[8]={13:"hidden"};e[9]=u.appendVal(8,"line-through");e[10]=u.delete(2);e[11]={2:"var(--ansi-font-1)"};e[12]={2:"var(--ansi-font-2)"};e[13]={2:"var(--ansi-font-3)"};e[14]={2:"var(--ansi-font-4)"};e[15]={2:"var(--ansi-font-5)"};e[16]={2:"var(--ansi-font-6)"};e[17]={2:"var(--ansi-font-7)"};e[18]={2:"var(--ansi-font-8)"};e[19]={2:"var(--ansi-font-9)"};e[21]={10:"underline",11:"double"};e[22]=u.delete(5);e[23]=u.delete(4);e[24]=u.removeVal(8,"underline");e[28]=u.delete(13);e[29]=u.removeVal(8,"line-through");e[30]={1:`var(--ansi-black, ${a.xtermjs.black})`};e[31]={1:`var(--ansi-red, ${a.xtermjs.red})`};e[32]={1:`var(--ansi-green, ${a.xtermjs.green})`};e[33]={1:`var(--ansi-yellow, ${a.xtermjs.yellow})`};e[34]={1:`var(--ansi-blue, ${a.xtermjs.blue})`};e[35]={1:`var(--ansi-magenta, ${a.xtermjs.magenta})`};e[36]={1:`var(--ansi-cyan, ${a.xtermjs.cyan})`};e[37]={1:`var(--ansi-white, ${a.xtermjs.white})`};e[39]=u.delete(1);e[40]={0:`var(--ansi-black, ${a.xtermjs.black})`};e[41]={0:`var(--ansi-red, ${a.xtermjs.red})`};e[42]={0:`var(--ansi-green, ${a.xtermjs.green})`};e[43]={0:`var(--ansi-yellow, ${a.xtermjs.yellow})`};e[44]={0:`var(--ansi-blue, ${a.xtermjs.blue})`};e[45]={0:`var(--ansi-magenta, ${a.xtermjs.magenta})`};e[46]={0:`var(--ansi-cyan, ${a.xtermjs.cyan})`};e[47]={0:`var(--ansi-white, ${a.xtermjs.white})`};e[49]=u.delete(0);e[51]={7:"var(--ansi-frame-outline, 1px solid)"};e[53]=u.appendVal(8,"overline");e[54]=u.delete(7);e[55]=u.removeVal(8,"overline");e[59]=u.delete(9);e[73]={12:"super",3:"var(--ansi-superscript-font-size, 80%)"};e[74]={12:"sub",3:"var(--ansi-subscript-font-size, 80%)"};e[75]=u.delete(12,3);e[90]={1:`var(--ansi-bright-black, ${a.xtermjs["bright-black"]})`};e[91]={1:`var(--ansi-bright-red, ${a.xtermjs["bright-red"]})`};e[92]={1:`var(--ansi-bright-green, ${a.xtermjs["bright-green"]})`};e[93]={1:`var(--ansi-bright-yellow, ${a.xtermjs["bright-yellow"]})`};e[94]={1:`var(--ansi-bright-blue, ${a.xtermjs["bright-blue"]})`};e[95]={1:`var(--ansi-bright-magenta, ${a.xtermjs["bright-magenta"]})`};e[96]={1:`var(--ansi-bright-cyan, ${a.xtermjs["bright-cyan"]})`};e[97]={1:`var(--ansi-bright-white, ${a.xtermjs["bright-white"]})`};e[100]={0:`var(--ansi-bright-black, ${a.xtermjs["bright-black"]})`};e[101]={0:`var(--ansi-bright-red, ${a.xtermjs["bright-red"]})`};e[102]={0:`var(--ansi-bright-green, ${a.xtermjs["bright-green"]})`};e[103]={0:`var(--ansi-bright-yellow, ${a.xtermjs["bright-yellow"]})`};e[104]={0:`var(--ansi-bright-blue, ${a.xtermjs["bright-blue"]})`};e[105]={0:`var(--ansi-bright-magenta, ${a.xtermjs["bright-magenta"]})`};e[106]={0:`var(--ansi-bright-cyan, ${a.xtermjs["bright-cyan"]})`};e[107]={0:`var(--ansi-bright-white, ${a.xtermjs["bright-white"]})`};const c=new Array(16);c[0]="black";c[1]="red";c[2]="green";c[3]="yellow";c[4]="blue";c[5]="magenta";c[6]="cyan";c[7]="white";c[8]="bright-black";c[9]="bright-red";c[10]="bright-green";c[11]="bright-yellow";c[12]="bright-blue";c[13]="bright-magenta";c[14]="bright-cyan";c[15]="bright-white";function b(l){switch(l){case"38":return 1;case"48":return 0;case"58":return 9;default:throw new Error("not implemented")}}function k(l,r){const n=l.text.split(";");if(n.length!==3)return;const t=b(n[0]),i=parseInt(n[2],10);if(0<=i&&i<=15){const s=c[i];r.set(t,`var(--ansi-${s}, ${a.xtermjs[s]})`)}else if(16<=i&&i<=231){const s=i-16,o=[0,95,135,175,215,255],d=o[s/36%6|0],h=o[s/6%6|0],v=o[s%6];r.set(t,`rgb(${d},${h},${v})`)}else if(232<=i&&i<=255){const s=8+(i-232)*10;r.set(t,`var(--ansi-gray-${256-i}, rgb(${s},${s},${s}))`)}}function I(l,r){const n=l.text.split(";");if(n.length!==5)return;const t=b(n[0]),[,,i,s,o]=n;r.set(t,`rgb(${i},${s},${o})`)}function z(l,r){if(/^(38|48|58);(2|5);/.test(l.text)){l.text[3]==="2"?I(l,r):k(l,r);return}l.text.split(";").forEach(n=>{const t=parseInt(n||"0",10);if(t===0){r.clear();return}const i=e[t];i&&(typeof i=="function"?i(r):r.update(i))})}function R(l){return A.test(l)}function S(l){return l.replaceAll(w,"")}class V{toHtml(r){const n=new u;let t="",i=!1;return Array.from(new j(r)).forEach(s=>{switch(s.kind){case 1:t+=m(s.text);break;case 4:i&&(t+="</span>",i=!1),z(s,n),n.size&&(t+=`<span style="${n.toString()}">`,i=!0);break}}),i&&(t+="</span>"),t}}exports.FancyAnsi=V;exports.hasAnsi=R;exports.stripAnsi=S;
